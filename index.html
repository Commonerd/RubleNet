<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang-key="pageTitle">Калькулятор Чистой Зарплаты в России | Расчет зарплаты, налогов, чистой суммы к получению</title>
    <meta name="description" data-lang-key="metaDescription" content="Быстро и легко рассчитайте чистую зарплату в России. Проверьте сумму, которую вы фактически получите после вычета налога НДФЛ, и легко управляйте историей расчетов.">
    <meta name="keywords" data-lang-key="metaKeywords" content="чистая зарплата Россия, зарплата Россия, НДФЛ, налоги Россия, подоходный налог Россия, зарплата, калькулятор налогов, расчет чистой зарплаты, доходы физических лиц, доход от работы, бизнес-доход">
    <meta name="author" content="AI Calculator Service">
    <meta property="og:title" data-lang-key="ogTitle" content="Калькулятор Чистой Зарплаты в России">
    <meta property="og:description" data-lang-key="ogDescription" content="Быстро и легко рассчитайте чистую зарплату в России. Проверьте сумму, которую вы фактически получите после вычета налога НДФЛ, и легко управляйте историей расчетов.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://rublenet.netlify.app">
    <!-- Favicon: Russian Ruble symbol (₽) as SVG icon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>₽</text></svg>">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: '#1a73e8', // Google Blue
                        secondary: '#f0f2f5', // Very light gray for background and section backgrounds
                        tertiary: '#ffffff', // White for cards/main container
                        textPrimary: '#333',
                        textSecondary: '#6b7280', // Gray for subheadings and info text
                        accentGreen: '#10b981', // Strong green for positive results
                        accentRed: '#dc2626', // Red for warnings/delete buttons
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', 'Arial', sans-serif; /* Added Arial as fallback for broader Cyrillic support */
            background-color: theme('colors.secondary');
            color: theme('colors.textPrimary');
            line-height: 1.6;
            margin: 0;
            padding: 1rem; /* Global padding for smaller screens */
        }
        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: theme('colors.tertiary');
            border-radius: 20px; /* More rounded corners for expressive style */
            box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.15), 0 5px 10px -5px rgba(0, 0, 0, 0.08); /* Stronger shadow */
        }
        @media (max-width: 768px) {
            .container {
                margin: 1rem auto; /* Less margin on mobile */
                padding: 1rem;
                border-radius: 12px; /* Slightly less rounded on small screens */
            }
            body {
                padding: 0.5rem;
            }
        }
        input[type="number"] {
            -moz-appearance: textfield; /* Firefox */
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: theme('colors.textPrimary');
        }
        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid theme('colors.gray.300'); /* Lighter border */
            border-radius: 12px; /* More rounded input fields */
            font-size: 1rem;
            color: theme('colors.textPrimary');
            background-color: theme('colors.white');
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .form-input:focus {
            outline: none;
            border-color: theme('colors.primary');
            box-shadow: 0 0 0 4px rgba(26, 115, 232, 0.3); /* Blue glow on focus */
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 12px; /* More rounded buttons */
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out, box-shadow 0.2s ease-in-out;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .btn-primary {
            background-color: theme('colors.primary');
            color: white;
        }
        .btn-primary:hover {
            background-color: #1565c0;
            transform: translateY(-2px); /* Slightly more pronounced hover */
            box-shadow: 0 6px 10px -2px rgba(0, 0, 0, 0.15), 0 3px 6px -2px rgba(0, 0, 0, 0.08);
        }
        .btn-secondary {
            background-color: theme('colors.gray.200');
            color: theme('colors.textPrimary');
        }
        .btn-secondary:hover {
            background-color: theme('colors.gray.300');
            transform: translateY(-2px);
            box-shadow: 0 6px 10px -2px rgba(0, 0, 0, 0.15), 0 3px 6px -2px rgba(0, 0, 0, 0.08);
        }
        .result-box {
            background-color: theme('colors.green.50'); /* Lighter green for result box background */
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid theme('colors.green.200'); /* Green border */
            text-align: center;
            margin-top: 1.5rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05); /* Subtle shadow for result box */
        }
        .result-box p {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: theme('colors.textPrimary');
        }
        .result-box strong {
            font-size: 2.5rem; /* Larger font for main result */
            font-weight: 800; /* Bolder */
            color: theme('colors.accentGreen');
            display: block;
            margin-top: 0.5rem;
            letter-spacing: -0.025em; /* Tighter letter spacing */
        }
        .section-heading {
            font-size: 2rem; /* Larger headings */
            font-weight: 700;
            color: theme('colors.textPrimary');
            margin-bottom: 1.5rem;
            text-align: center;
            line-height: 1.2;
        }
        @media (max-width: 768px) {
            .section-heading {
                font-size: 1.75rem; /* Smaller headings on mobile */
            }
            .result-box strong {
                font-size: 2rem;
            }
        }
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background-color: theme('colors.tertiary'); /* White background for table */
            border-radius: 12px; /* Rounded table corners */
            overflow: hidden; /* Ensures rounded corners clip content */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }
        .history-table th, .history-table td {
            padding: 0.85rem 1rem; /* More padding for table cells */
            border-bottom: 1px solid theme('colors.gray.200');
            text-align: left;
            font-size: 0.95rem;
            color: theme('colors.textPrimary');
        }
        .history-table th {
            background-color: theme('colors.gray.100');
            font-weight: 600;
            color: theme('colors.gray.700');
        }
        .history-table tr:hover {
            background-color: theme('colors.gray.50'); /* Subtle hover effect */
        }
        .footer {
            text-align: center;
            margin-top: 3rem;
            padding: 1.5rem;
            background-color: theme('colors.gray.100');
            border-radius: 12px;
            font-size: 0.9rem;
            color: theme('colors.gray.600');
            box-shadow: 0 -5px 10px -5px rgba(0, 0, 0, 0.05); /* Shadow for footer */
        }
        .language-selector-container {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 1.5rem; /* More margin */
        }
        .language-selector {
            padding: 0.6rem 1.2rem; /* Larger touch target */
            border-radius: 12px; /* More rounded */
            border: 1px solid theme('colors.gray.300');
            background-color: white;
            cursor: pointer;
            font-size: 0.95rem;
            color: theme('colors.textPrimary');
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); /* Subtle shadow */
            -webkit-appearance: none; /* Remove default select arrow */
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.2em;
            padding-right: 2.5rem; /* Make space for custom arrow */
        }
        .language-selector:focus {
            outline: none;
            border-color: theme('colors.primary');
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.3);
        }
    </style>
</head>
<body class="font-inter">
    <div class="container">
        <div class="language-selector-container">
            <select id="languageSelector" class="language-selector">
                <option value="ru">Русский (Russian)</option>
                <option value="en">English (Английский)</option>
            </select>
        </div>

        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-primary mb-2" data-lang-key="mainHeading">Калькулятор Чистой Зарплаты в России</h1>
            <p class="text-xl text-gray-600" data-lang-key="subHeading">Рассчитайте фактическую сумму к получению после вычета НДФЛ из вашей зарплаты в российских рублях (₽).</p>
        </header>

        <section class="mb-8 p-6 bg-secondary rounded-lg shadow-inner">
            <h2 class="section-heading mb-6" data-lang-key="inputSectionHeading">Введите информацию о зарплате</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <label for="grossSalary" class="form-label" data-lang-key="grossSalaryLabel">Валовая зарплата (Gross Salary) ₽</label>
                    <input type="number" id="grossSalary" class="form-input" data-lang-key="grossSalaryPlaceholder" placeholder="Введите валовую зарплату (напр., 100000)" value="0">
                </div>
                <div>
                    <label for="ndflRate" class="form-label" data-lang-key="ndflRateLabel">Ставка НДФЛ (%)</label>
                    <input type="number" id="ndflRate" class="form-input" data-lang-key="ndflRatePlaceholder" placeholder="Напр., 13 (по умолчанию)" value="13" step="0.1" min="0" max="100">
                </div>
            </div>
            <p class="text-sm text-gray-500 mt-4" data-lang-key="ndflInfo">
                <strong class="font-bold">Информация о НДФЛ (налог на доходы физических лиц):</strong> Для резидентов РФ ставка обычно составляет 13% до годового дохода в 5 миллионов рублей, а затем 15% на сумму, превышающую этот лимит. Для нерезидентов или при определенных видах дохода ставка может отличаться, поэтому, пожалуйста, уточните и введите точную ставку. Значение по умолчанию — 13%. Данный калькулятор сфокусирован на расчете НДФЛ, применяемого к доходам физических лиц, включая доходы по найму.
            </p>
        </section>

        <section id="resultSection" class="result-box hidden">
            <h2 class="section-heading mb-4" data-lang-key="resultSectionHeading">Результаты расчета</h2>
            <p data-lang-key="displayGrossSalaryText">Валовая зарплата: <span id="displayGrossSalary">0 ₽</span></p>
            <p data-lang-key="displayNdflAmountText">Сумма НДФЛ: <span id="displayNdflAmount">0 ₽</span></p>
            <p class="mt-4" data-lang-key="netSalaryLabel">Чистая зарплата (Net Salary)</p>
            <strong id="netSalaryResult">0 ₽</strong>
        </section>

        <section class="mb-8 mt-10">
            <h2 class="section-heading" data-lang-key="historySectionHeading">История расчетов</h2>
            <div id="historyMessage" class="text-center text-gray-500 mb-4" data-lang-key="noHistoryMessage">Пока нет истории расчетов.</div>
            <div class="overflow-x-auto">
                <table id="historyTable" class="history-table hidden">
                    <thead>
                        <tr>
                            <th data-lang-key="historyGrossSalaryCol">Валовая зарплата</th>
                            <th data-lang-key="historyNdflRateCol">Ставка НДФЛ</th>
                            <th data-lang-key="historyNdflAmountCol">Сумма НДФЛ</th>
                            <th data-lang-key="historyNetSalaryCol">Чистая зарплата</th>
                            <th data-lang-key="historyDateCol">Дата расчета</th>
                            <th></th> <!-- for delete button -->
                        </tr>
                    </thead>
                    <tbody id="historyBody">
                        <!-- History items will be inserted here -->
                    </tbody>
                </table>
            </div>
            <button id="clearHistoryBtn" class="btn btn-secondary w-full mt-6 hidden" data-lang-key="clearHistoryBtn">Очистить всю историю</button>
        </section>
        
        <section class="p-6 bg-secondary rounded-lg shadow-inner mt-8">
            <h2 class="section-heading text-xl" data-lang-key="howItWorksHeading">Как работает этот калькулятор?</h2>
            <p class="text-gray-700 mb-4" data-lang-key="howItWorksParagraph1">
                Этот калькулятор чистой зарплаты в России выполняет простой расчет на основе введенной вами валовой зарплаты и ставки НДФЛ (налога на доходы физических лиц). В большинстве случаев в России НДФЛ является основным подоходным налогом и вычитается непосредственно из зарплаты. Этот калькулятор использует формулу <strong class="font-semibold">Валовая зарплата × (1 - Ставка НДФЛ / 100)</strong> для расчета чистой зарплаты.
            </p>
            <p class="text-gray-700 mb-4" data-lang-key="howItWorksParagraph2">
                Эта услуга не охватывает все детали сложного российского налогового законодательства (например, различные вычеты, отчисления на социальное страхование, налоги для нерезидентов и т. д.). Однако она предоставляет самую важную информацию для тех, кто хочет быстро оценить свою базовую чистую зарплату, устраняя ненужную сложность. Он особенно полезен для иностранных работников, которые получают или планируют получать зарплату в России, или для резидентов РФ, которые хотят легко проверить свой чистый доход.
            </p>
            <p class="text-gray-700 font-bold mb-4" data-lang-key="importantNoteBusinessIncome">
                <span class="text-red-600">Важное примечание для индивидуальных предпринимателей и самозанятых:</span> Этот калькулятор ориентирован на расчет НДФЛ (налога на доходы физических лиц), который взимается с доходов по найму и некоторых других доходов физических лиц. Для индивидуальных предпринимателей (ИП) и самозанятых лиц в России действуют другие налоговые режимы (например, УСН, Патент, Налог на профессиональный доход), которые имеют свои уникальные правила расчета и не покрываются данным калькулятором. Пожалуйста, обратитесь к специализированным ресурсам или налоговым консультантам для расчета налогов по вашим доходам от предпринимательской деятельности.
            </p>
            <p class="text-gray-700" data-lang-key="howItWorksParagraph3">
                Наш сервис реализует философию 'все быстро', показывая результаты **сразу после ввода валовой зарплаты**. Кроме того, **история расчетов сохраняется в локальном хранилище браузера**, что позволяет сохранять предыдущие записи расчетов, даже если вы закрыли и снова открыли браузер. Это будет очень полезно для регулярной проверки зарплаты или планирования бюджета.
            </p>
            <h3 class="text-lg font-bold text-gray-800 mt-6 mb-2" data-lang-key="seoGeoHeading">Информация об оптимизации для SEO и GEO</h3>
            <p class="text-gray-700" data-lang-key="seoGeoParagraph">
                Эта веб-страница была создана с учетом оптимизации для поисковых систем Google (SEO) и поисковых систем с использованием ИИ (Generative Engine Optimization, GEO). Путем правильного размещения ключевых слов ("чистая зарплата Россия", "НДФЛ", "зарплата Россия") и предоставления четких и кратких ответов на запросы пользователей, мы помогли поисковым системам и чат-ботам с ИИ лучше понимать контент и доносить его до пользователей. Простой дизайн и высокая скорость загрузки улучшают пользовательский опыт и положительно влияют на поисковые рейтинги.
            </p>
        </section>

        <footer class="footer">
            <p data-lang-key="copyright">&copy; 2024 RubleNet. Все права защищены.</p>
            <p data-lang-key="disclaimer">Данный калькулятор предназначен только для справочных целей, для получения точной налоговой информации обращайтесь к специалистам.</p>
        </footer>
    </div>

    <script>
        const grossSalaryInput = document.getElementById('grossSalary');
        const ndflRateInput = document.getElementById('ndflRate');
        const netSalaryResult = document.getElementById('netSalaryResult');
        const displayGrossSalary = document.getElementById('displayGrossSalary');
        const displayNdflAmount = document.getElementById('displayNdflAmount');
        const resultSection = document.getElementById('resultSection');
        const historyBody = document.getElementById('historyBody');
        const historyMessage = document.getElementById('historyMessage');
        const historyTable = document.getElementById('historyTable');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');
        const languageSelector = document.getElementById('languageSelector');

        const STORAGE_KEY = 'rubleNetCalculations';
        const LANG_STORAGE_KEY = 'rubleNetLanguage';

        const translations = {
            pageTitle: {
                ru: 'Калькулятор Чистой Зарплаты в России | Расчет зарплаты, налогов, чистой суммы к получению',
                en: 'Russia Net Salary Calculator | Calculate Russian Salary, Taxes, Net Pay'
            },
            metaDescription: {
                ru: 'Быстро и легко рассчитайте чистую зарплату в России. Проверьте сумму, которую вы фактически получите после вычета налога НДФЛ, и легко управляйте историей расчетов.',
                en: 'Quickly and easily calculate your net salary in Russia. Check the amount you will actually receive after NDFL tax deductions, and easily manage your calculation history.'
            },
            metaKeywords: {
                ru: 'чистая зарплата Россия, зарплата Россия, НДФЛ, налоги Россия, подоходный налог Россия, зарплата, калькулятор налогов, расчет чистой зарплаты, доходы физических лиц, доход от работы, бизнес-доход',
                en: 'net salary Russia, Russia salary, NDFL, Russia taxes, Russia income tax, salary calculator, net pay calculator, personal income, employment income, business income'
            },
            ogTitle: {
                ru: 'Калькулятор Чистой Зарплаты в России',
                en: 'Russia Net Salary Calculator'
            },
            ogDescription: {
                ru: 'Быстро и легко рассчитайте чистую зарплату в России. Проверьте сумму, которую вы фактически получите после вычета налога НДФЛ, и легко управляйте историей расчетов.',
                en: 'Quickly and easily calculate your net salary in Russia. Check the amount you will actually receive after NDFL tax deductions, and easily manage your calculation history.'
            },
            mainHeading: {
                ru: 'Калькулятор Чистой Зарплаты в России',
                en: 'Russia Net Salary Calculator'
            },
            subHeading: {
                ru: 'Рассчитайте фактическую сумму к получению после вычета НДФЛ из вашей зарплаты в российских рублях (₽).',
                en: 'Calculate the actual amount you will receive after NDFL deductions from your gross salary in Russian Rubles (₽).'
            },
            inputSectionHeading: {
                ru: 'Введите информацию о зарплате',
                en: 'Enter Salary Information'
            },
            grossSalaryLabel: {
                ru: 'Валовая зарплата (Gross Salary) ₽',
                en: 'Gross Salary (Gross Salary) ₽'
            },
            grossSalaryPlaceholder: {
                ru: 'Введите валовую зарплату (напр., 100000)',
                en: 'Enter gross salary (e.g., 100000)'
            },
            ndflRateLabel: {
                ru: 'Ставка НДФЛ (%)',
                en: 'NDFL Rate (%)'
            },
            ndflRatePlaceholder: {
                ru: 'Напр., 13 (по умолчанию)',
                en: 'e.g., 13 (default)'
            },
            ndflInfo: {
                ru: `<strong>Информация о НДФЛ (налог на доходы физических лиц):</strong> Для резидентов РФ ставка обычно составляет 13% до годового дохода в 5 миллионов рублей, а затем 15% на сумму, превышающую этот лимит. Для нерезидентов или при определенных видах дохода ставка может отличаться, поэтому, пожалуйста, уточните и введите точную ставку. Значение по умолчанию — 13%. Данный калькулятор сфокусирован на расчете НДФЛ, применяемого к доходам физических лиц, включая доходы по найму.`,
                en: `<strong>NDFL (Personal Income Tax) Information:</strong> For Russian residents, the rate is typically 13% up to an annual income of 5 million rubles, and then 15% on the amount exceeding this limit. For non-residents or certain types of income, the rate may differ, so please verify and enter the correct rate. The default value is 13%. This calculator focuses on NDFL calculations applicable to individual income, including employment income.`
            },
            resultSectionHeading: {
                ru: 'Результаты расчета',
                en: 'Calculation Results'
            },
            displayGrossSalaryText: {
                ru: 'Валовая зарплата: ',
                en: 'Gross Salary: '
            },
            displayNdflAmountText: {
                ru: 'Сумма НДФЛ: ',
                en: 'NDFL Amount: '
            },
            netSalaryLabel: {
                ru: 'Чистая зарплата (Net Salary)',
                en: 'Net Salary (Net Salary)'
            },
            historySectionHeading: {
                ru: 'История расчетов',
                en: 'Calculation History'
            },
            noHistoryMessage: {
                ru: 'Пока нет истории расчетов.',
                en: 'No calculation history yet.'
            },
            historyGrossSalaryCol: {
                ru: 'Валовая зарплата',
                en: 'Gross Salary'
            },
            historyNdflRateCol: {
                ru: 'Ставка НДФЛ',
                en: 'NDFL Rate'
            },
            historyNdflAmountCol: {
                ru: 'Сумма НДФЛ',
                en: 'NDFL Amount'
            },
            historyNetSalaryCol: {
                ru: 'Чистая зарплата',
                en: 'Net Salary'
            },
            historyDateCol: {
                ru: 'Дата расчета',
                en: 'Calculation Date'
            },
            clearHistoryBtn: {
                ru: 'Очистить всю историю',
                en: 'Clear All History'
            },
            howItWorksHeading: {
                ru: 'Как работает этот калькулятор?',
                en: 'How This Calculator Works?'
            },
            howItWorksParagraph1: {
                ru: `Этот калькулятор чистой зарплаты в России выполняет простой расчет на основе введенной вами валовой зарплаты и ставки НДФЛ (налога на доходы физических лиц). В большинстве случаев в России НДФЛ является основным подоходным налогом и вычитается непосредственно из зарплаты. Этот калькулятор использует формулу <strong class="font-semibold">Валовая зарплата × (1 - Ставка НДФЛ / 100)</strong> для расчета чистой зарплаты.`,
                en: `This Russia net salary calculator performs a simple calculation based on your entered gross salary and the NDFL (Personal Income Tax) rate. In most cases in Russia, NDFL is the main income tax and is deducted directly from the salary. This calculator uses the formula <strong class="font-semibold">Gross Salary × (1 - NDFL Rate / 100)</strong> to calculate the net salary.`
            },
            howItWorksParagraph2: {
                ru: `Эта услуга не охватывает все детали сложного российского налогового законодательства (например, различные вычеты, отчисления на социальное страхование, налоги для нерезидентов и т. д.). Однако она предоставляет самую важную информацию для тех, кто хочет быстро оценить свою базовую чистую зарплату, устраняя ненужную сложность. Он особенно полезен для иностранных работников, которые получают или планируют получать зарплату в России, или для резидентов РФ, которые хотят легко проверить свой чистый доход.`,
                en: `This service does not cover all details of complex Russian tax legislation (e.g., various deductions, social insurance contributions, non-resident taxes, etc.). However, it provides the most important information for those who want to quickly estimate their basic net salary, eliminating unnecessary complexity. It is especially useful for foreign workers who receive or plan to receive salaries in Russia, or for Russian residents who want to easily check their net income.`
            },
            importantNoteBusinessIncome: {
                ru: `<span class="text-red-600">Важное примечание для индивидуальных предпринимателей и самозанятых:</span> Этот калькулятор ориентирован на расчет НДФЛ (налога на доходы физических лиц), который взимается с доходов по найму и некоторых других доходов физических лиц. Для индивидуальных предпринимателей (ИП) и самозанятых лиц в России действуют другие налоговые режимы (например, УСН, Патент, Налог на профессиональный доход), которые имеют свои уникальные правила расчета и не покрываются данным калькулятором. Пожалуйста, обратитесь к специализированным ресурсам или налоговым консультантам для расчета налогов по вашим доходам от предпринимательской деятельности.`,
                en: `<span class="text-red-600">Important Note for Individual Entrepreneurs and Self-Employed Individuals:</span> This calculator is focused on calculating NDFL (Personal Income Tax), which is levied on employment income and certain other individual incomes. For individual entrepreneurs (IP) and self-employed individuals in Russia, other tax regimes (e.g., USN, Patent, Professional Income Tax) apply, which have their own unique calculation rules and are not covered by this calculator. Please refer to specialized resources or tax consultants for calculating taxes on your business income.`
            },
            howItWorksParagraph3: {
                ru: `Наш сервис реализует философию 'все быстро', показывая результаты **сразу после ввода валовой зарплаты**. Кроме того, **история расчетов сохраняется в локальном хранилище браузера**, что позволяет сохранять предыдущие записи расчетов, даже если вы закрыли и снова открыли браузер. Это будет очень полезно для регулярной проверки зарплаты или планирования бюджета.`,
                en: `Our service embodies the philosophy of 'everything fast,' displaying results **immediately upon entering the gross salary**. Additionally, **calculation history is saved in the browser's local storage**, allowing you to retain previous calculation records even if you close and reopen your browser. This will be very useful for regular salary checks or budget planning.`
            },
            seoGeoHeading: {
                ru: 'Информация об оптимизации для SEO и GEO',
                en: 'SEO and GEO Optimization Information'
            },
            seoGeoParagraph: {
                ru: `Эта веб-страница была создана с учетом оптимизации для поисковых систем Google (SEO) и поисковых систем с использованием ИИ (Generative Engine Optimization, GEO). Путем правильного размещения ключевых слов ("чистая зарплата Россия", "НДФЛ", "зарплата Россия") и предоставления четких и кратких ответов на запросы пользователей, мы помогли поисковым системам и чат-ботам с ИИ лучше понимать контент и доносить его до пользователей. Простой дизайн и высокая скорость загрузки улучшают пользовательский опыт и положительно влияют на поисковые рейтинги.`,
                en: `This webpage was created with Google Search Engine Optimization (SEO) and AI search (Generative Engine Optimization, GEO) in mind. By appropriately placing keywords ("Russia net salary", "NDFL", "Russia salary") and providing clear and concise answers to user queries, we have helped search engines and AI chatbots better understand the content and deliver it to users. Simple design and fast loading speed improve user experience and positively affect search rankings.`
            },
            copyright: {
                ru: '&copy; 2024 RubleNet. Все права защищены.',
                en: '&copy; 2024 RubleNet. All rights reserved.'
            },
            disclaimer: {
                ru: 'Данный калькулятор предназначен только для справочных целей, для получения точной налоговой информации обращайтесь к специалистам.',
                en: 'This calculator is for reference only; for accurate tax information, please consult with a specialist.'
            },
            invalidGrossSalary: {
                ru: 'Недействительная валовая зарплата',
                en: 'Invalid gross salary'
            },
            invalidNdflRate: {
                ru: 'Недействительная ставка налога',
                en: 'Invalid tax rate'
            },
            deleteButton: {
                ru: 'Удалить',
                en: 'Delete'
            }
        };

        let currentLang = 'ru'; // Default language

        // Function to format amounts in Russian Ruble currency
        function formatRubles(amount, lang = currentLang) {
            return new Intl.NumberFormat(lang === 'ru' ? 'ru-RU' : 'en-US', {
                style: 'currency',
                currency: 'RUB',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }

        // Update all text content based on selected language
        function updateContent(lang) {
            document.querySelectorAll('[data-lang-key]').forEach(element => {
                const key = element.getAttribute('data-lang-key');
                if (translations[key] && translations[key][lang]) {
                    if (element.tagName === 'INPUT' && element.hasAttribute('placeholder')) {
                        element.setAttribute('placeholder', translations[key][lang]);
                    } else if (element.tagName === 'TITLE') {
                        element.textContent = translations[key][lang];
                    } else if (element.tagName === 'META') {
                        if (element.name === 'description' || element.name === 'keywords') {
                            element.setAttribute('content', translations[key][lang]);
                        } else if (element.property === 'og:title' || element.property === 'og:description') {
                             element.setAttribute('content', translations[key][lang]);
                        }
                    }
                     else {
                        element.innerHTML = translations[key][lang]; // Use innerHTML for rich text like strong tags
                    }
                }
            });
            // Update the display text for the result section
            // Ensure values are numbers before formatting
            const gross = parseFloat(grossSalaryInput.value) || 0;
            const rate = parseFloat(ndflRateInput.value) || 0;
            const ndfl = gross * (rate / 100);
            const net = gross - ndfl;

            displayGrossSalary.textContent = translations.displayGrossSalaryText[lang] + formatRubles(gross, lang);
            displayNdflAmount.textContent = translations.displayNdflAmountText[lang] + formatRubles(ndfl, lang);
            netSalaryResult.textContent = formatRubles(net, lang);

            currentLang = lang; // Update the current language
            loadHistory(); // Re-render history with new language timestamps
        }

        // Perform calculation and update results
        function calculateAndDisplay() {
            const grossSalary = parseFloat(grossSalaryInput.value);
            const ndflRate = parseFloat(ndflRateInput.value);

            if (isNaN(grossSalary) || grossSalary < 0) {
                netSalaryResult.textContent = translations.invalidGrossSalary[currentLang];
                displayGrossSalary.textContent = `0 ₽`; // Keep currency symbol fixed for input fields
                displayNdflAmount.textContent = `0 ₽`;
                resultSection.classList.add('hidden');
                return;
            }
            if (isNaN(ndflRate) || ndflRate < 0 || ndflRate > 100) {
                netSalaryResult.textContent = translations.invalidNdflRate[currentLang];
                displayGrossSalary.textContent = translations.displayGrossSalaryText[currentLang] + formatRubles(grossSalary);
                displayNdflAmount.textContent = translations.displayNdflAmountText[currentLang] + `0 ₽`; // Cannot calculate tax if rate is invalid
                resultSection.classList.remove('hidden');
                return;
            }

            const ndflAmount = grossSalary * (ndflRate / 100);
            const netSalary = grossSalary - ndflAmount;

            displayGrossSalary.textContent = translations.displayGrossSalaryText[currentLang] + formatRubles(grossSalary);
            displayNdflAmount.textContent = translations.displayNdflAmountText[currentLang] + formatRubles(ndflAmount);
            netSalaryResult.textContent = formatRubles(netSalary);
            resultSection.classList.remove('hidden');

            saveCalculationToHistory(grossSalary, ndflRate, ndflAmount, netSalary);
        }

        // Load calculation history from local storage
        function loadHistory() {
            try {
                const history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
                renderHistory(history);
            } catch (e) {
                console.error("Failed to parse history from local storage:", e);
                localStorage.removeItem(STORAGE_KEY); // Corrupted data, clear it
                renderHistory([]);
            }
        }

        // Save calculation to local storage history
        function saveCalculationToHistory(grossSalary, ndflRate, ndflAmount, netSalary) {
            const now = new Date();
            const timestamp = now.toLocaleDateString(currentLang === 'ru' ? 'ru-RU' : 'en-US') + ' ' + now.toLocaleTimeString(currentLang === 'ru' ? 'ru-RU' : 'en-US');

            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            
            // Avoid saving identical consecutive calculations unless data has changed significantly
            const lastEntry = history.length > 0 ? history[0] : null;
            if (lastEntry &&
                Math.abs(lastEntry.grossSalary - grossSalary) < 0.01 && // Compare with a small tolerance
                Math.abs(lastEntry.ndflRate - ndflRate) < 0.01) {
                return;
            }

            // Add new calculation to the beginning
            const newEntry = {
                id: Date.now(), // Unique ID for deletion
                grossSalary: grossSalary,
                ndflRate: ndflRate,
                ndflAmount: ndflAmount,
                netSalary: netSalary,
                timestamp: timestamp
            };
            history.unshift(newEntry); // Add to the start
            
            // Limit history to, e.g., 20 items to prevent excessive storage
            if (history.length > 20) {
                history = history.slice(0, 20);
            }

            localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
            renderHistory(history);
        }

        // Render calculation history on the screen
        function renderHistory(history) {
            historyBody.innerHTML = '';
            if (history.length === 0) {
                historyMessage.classList.remove('hidden');
                historyTable.classList.add('hidden');
                clearHistoryBtn.classList.add('hidden');
                return;
            }

            historyMessage.classList.add('hidden');
            historyTable.classList.remove('hidden');
            clearHistoryBtn.classList.remove('hidden');

            history.forEach(item => {
                const row = historyBody.insertRow();
                row.innerHTML = `
                    <td>${formatRubles(item.grossSalary, currentLang)}</td>
                    <td>${item.ndflRate}%</td>
                    <td>${formatRubles(item.ndflAmount, currentLang)}</td>
                    <td>${formatRubles(item.netSalary, currentLang)}</td>
                    <td>${item.timestamp}</td>
                    <td><button class="text-red-500 hover:text-red-700 font-bold delete-btn" data-id="${item.id}">${translations.deleteButton[currentLang]}</button></td>
                `;
            });

            // Attach event listeners for delete buttons
            document.querySelectorAll('.delete-btn').forEach(button => {
                button.onclick = (event) => {
                    const idToDelete = parseInt(event.target.dataset.id);
                    deleteCalculation(idToDelete);
                };
            });
        }

        // Delete a specific calculation from history
        function deleteCalculation(id) {
            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            history = history.filter(item => item.id !== id);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
            renderHistory(history);
        }

        // Clear all calculation history
        function clearAllHistory() {
            localStorage.removeItem(STORAGE_KEY);
            renderHistory([]);
        }

        // Event Listeners
        grossSalaryInput.addEventListener('input', calculateAndDisplay);
        ndflRateInput.addEventListener('input', calculateAndDisplay);
        clearHistoryBtn.addEventListener('click', clearAllHistory);
        languageSelector.addEventListener('change', (event) => {
            const newLang = event.target.value;
            localStorage.setItem(LANG_STORAGE_KEY, newLang);
            updateContent(newLang);
            calculateAndDisplay(); // Recalculate to update display strings and history timestamps
        });


        // Run on initial page load
        document.addEventListener('DOMContentLoaded', () => {
            // Load preferred language
            const savedLang = localStorage.getItem(LANG_STORAGE_KEY) || 'ru'; // Default to Russian
            languageSelector.value = savedLang;
            updateContent(savedLang); // Apply saved language immediately

            // Set initial values from history if available, or defaults
            const history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            if (history.length > 0) {
                grossSalaryInput.value = history[0].grossSalary;
                ndflRateInput.value = history[0].ndflRate;
            } else {
                // Default values if no history
                grossSalaryInput.value = 100000; // Example default
                ndflRateInput.value = 13; // Standard NDFL
            }
            calculateAndDisplay(); // Perform initial calculation based on loaded/default values
            loadHistory(); // Load and display the full history
        });

    </script>
</body>
</html>
